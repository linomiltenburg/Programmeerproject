Introduction

Een paar maanden geleden kwam de Wereld Gezondheid Organisatie met het bericht dat het eten van vlees een vergroting van de kans op darmkanker oplevert. In aanvulling op dit artikel wil ik de correlatie tussen de wereldwijde vleesconsumptie en het voorkomen van darmkanker visualiseren. In de visualisatie is de wereldwijde vleesconsumptie tussen 1993 en 2002 te zien en de darmkanker incidentie van 2002. Dit product kan gebruikt worden om de lezer van het artikel te laten zien of er een daadwerkelijke correlatie is en om de lezer informatie te verschaffen over de vleesconsumptie in het land waarin hij of zij woont. Het heeft dus zowel een informatieve als een waarschuwende functie.

Technical design

Er is een interactie tussen de verschillend visualisaties in het dashboard. Deze zijn weergegeven in het figuur hieronder. De interactie en variabele die doorgegeven worden staan weergegeven in het figuur Technical design. Ten eerste geeft de slider door welke colourmap er weergegeven moet worden. Hierbij wordt een jaartal doormiddel van de functie updatSlider() doorgegeven aan de wereldkaart. Bij het klikken op een land in de wereldkaart wordt de naam van het desbetreffende land doorgegeven aan de barchart en de scatterplot door middel van de functie selectBar() en selectDot(). Deze twee grafieken reageren hierop door de desbetreffende bar en dot van het land een andere kleur te geven totdat er een ander land wordt geselecteerd. Ten slotte kunnen de barchart en de scatterplot ook de landnaam van een van beide grafieken doorgeven als er op geklikt wordt.

![alt tag](https://github.com/linomiltenburg/Programmeerproject/blob/master/doc/Technical%20design.jpg)

Om de wereldkaart te visualiseren is er gebruik gemaakt van de customizable SVG map DataMaps. De rest van de grafieken is gemaakt aan de hand van D3. Hiervoor zijn enkele voorbeelden gebruikt. De referenties hiervan vind je in de README.md.

Voor de visualisaties zijn er twee soorten data gebruikt. Ten eerste data over de darmkanker-incidentie per 100.000 inwoners per land in 2002 en ten tweede de vleesconsumptie per land tussen 1993 en 2002.

De data is verkregen van het WHO en van de Guardian. De data over de darmkanker-incidentie is van de site van de World Health Organisation. http://www-dep.iarc.fr/WHOdb/WHOdb.htm. Deze data staat in tabellen op de site en is in een text file te downloaden om deze handmatig te verwerken tot een CSV-file. De data van de voedselconsumptie is verkregen van het nieuwsmedium The Guardian. http://www.theguardian.com/environment/datablog/2009/sep/02/meat-consumption-per-capita-climate-change. De data was direct in CSV-vorm te downloaden. De dataset van de vleesconsumptie is vervolgens omgezet in een JSON-formaat en in een dictionary geplaatst. Dit wordt gedaan met het script scraper_meat_dictionary.py. Op die manier zijn ze klaar voor gebruik met D3. De data voor de scatterplot wordt klaargemaakt door scraper_correlation.py. De datasets zijn te vinden in de map data.


Challenges

Een van de challenges waar tegenaan gelopen werd was het laten zien van de vleesconsumptie over tijd. Hiervoor moest er een tool bedacht worden waarmee een specifiek jaar gekozen kon worden. Het makkelijkst leek in eerste instantie om 10 buttons toe te voegen met elk een jaar erop aangegeven. Maar het scrapen van de jaartallen van deze buttons bleek minder efficient dan gedacht. Daarnaast is er bij de buttons geen mogelijkheid tot sliden tussen de verschillende jaren. Een voorgeprogrammeerde slider tool van D3 had deze mogelijkheid wel. Echter was het verkrijgen van het geselecteerde jaartal niet direct te scrapen aangezien de slider percentages teruggeeft. Aan de hand van de functie updateSlider() wordt het percentage omgerekend naar het desbetreffende jaartal.

Een ander probleem waar tegen aangelopen werd, was de onderlinge interactie tussen de verschillende visualisaties. Bij het klikken op een land, bar of dot moet er een selectie van ditzelfde land in de rest van de visualisaties te zien zijn aan de hand van een verkleuring van de bar of dot. Het probleem was het feit dat de wereldkaart bij een onclick van een land de drieletterige code teruggaf. Echter is in al de data de volledige naam van het land aanwezig. In eerste instantie heb ik een functie geschreven om de drieletterige code om te zetten in de volledige  naam van het land2. Na een tip tijdens de presentatie bleek dit veel makkelijker te kunnen en kan men direct de volledige naam van het land verkrijgen door niet geography.id te selecteren maat geography.properties.name. Dit is een verbetering aangezien er minder onnodige code geschreven te worden

Een volgend probleem bij de interactie was het selecteren van slechts een bar/dot tegelijk. Het onclick event zorgde voor deze selectie. Hier lag het probleem niet. Het probleem zat hem in teruggaan van de voorheen geselecteerde bar of dot naar de standaardkleur bij selectie van een ander land. Op die manier is er altijd maar een selectie weergegeven. Dit is uiteindelijk opgelost door het land dat op dat moment geselecteerd wordt op te slaan in een variabele. Bij een nieuwe klik wordt door middel van een if-statement gecheckt of dit een ander land is. Als dit zo is wordt de vorige selectie weer gekleurd met de initiÃ«le kleur en wordt de nieuwe selectie opgeslagen in de variabele.

Tenslotte liep ik nog tegen het probleem dat niet elke dot en bar reageerde op het onclick event. Deze bug kwam enkel voor bij landen met een spatie in de naam. Het probleem lag bij het feit dat een id in html geen spaties mag bevatten. Een oplossing hiervoor is niet gevonden op het internet. Het probleem is uiteindelijk opgelost door handmatig streepjes op de plek van de spatie te plaatsen. 
